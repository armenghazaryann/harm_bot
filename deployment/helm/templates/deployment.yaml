apiVersion: apps/v1
kind: Deployment
metadata:
  name: "{{ include \"rag-etl.fullname\" . }}"
  labels:
    "helm.sh/chart": "{{ .Chart.Name }}-{{ .Chart.Version }}"
    "app.kubernetes.io/name": "{{ .Chart.Name }}"
    "app.kubernetes.io/instance": "{{ .Release.Name }}"
    "app.kubernetes.io/version": "{{ .Chart.AppVersion }}"
    "app.kubernetes.io/managed-by": "{{ .Release.Service }}"
spec:
  replicas: 1
  selector:
    matchLabels:
      "app.kubernetes.io/name": "{{ .Chart.Name }}"
      "app.kubernetes.io/instance": "{{ .Release.Name }}"
  template:
    metadata:
      labels:
        "app.kubernetes.io/name": "{{ .Chart.Name }}"
        "app.kubernetes.io/instance": "{{ .Release.Name }}"
    spec:
      containers:
        - name: "{{ .Chart.Name }}"
          image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
          imagePullPolicy: "{{ .Values.image.pullPolicy | default \"IfNotPresent\" }}"
          ports:
            - containerPort: 80
          resources:
            requests:
              memory: "64Mi"
              cpu: "250m"
            limits:
              memory: "128Mi"
              cpu: "500m"
